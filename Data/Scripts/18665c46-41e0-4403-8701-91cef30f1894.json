{
    "type": "script",
    "id": "18665c46-41e0-4403-8701-91cef30f1894",
    "name": "Interact_DChest",
    "sceneId": "aee3c0c9-4f51-4537-843d-07e84acaff1a",
    "propId": "22ddf87a-4024-4575-9e2b-242d667e4d12",
    "actorId": null,
    "trigger": {
        "type": "triggers.interact",
        "name": "Interact"
    },
    "entryPoints": [
        {
            "type": "scripts.entryPoint",
            "id": "bfefdaf4-b4a0-48f6-b64d-cf4a8d13cdf0",
            "name": "Main",
            "nodes": [
                {
                    "type": "nodes.onceOnly",
                    "id": "b59f499c-86d0-4095-85d0-ef4e3147fa2d",
                    "nodes": [
                        {
                            "type": "nodes.changeTags",
                            "id": "b76ddab1-fcbf-40a6-91b3-6464c79a723e",
                            "scope": "target",
                            "scopeId": null,
                            "scopeFilterId": null,
                            "tagsToAdd": "locked",
                            "tagsToRemove": null
                        }
                    ]
                },
                {
                    "type": "nodes.comment",
                    "message": "Probably over complicating this, but using this variable lets us not make unnecessary KneelDown calls (which will cause Shawn to kneel down again after we tell him to get up)",
                    "commentor": "Charles"
                },
                {
                    "type": "nodes.setVariable",
                    "name": "shawnKneeling",
                    "scope": "script",
                    "sceneId": "a2508b7e-a177-4a96-93bd-4d8ab88dffc4",
                    "source": {
                        "type": "variables.literal",
                        "value": "false",
                        "displayName": "Literal"
                    },
                    "add": false
                },
                {
                    "type": "nodes.showMenu",
                    "id": "e506ceb9-8008-4c19-b499-ff63bd7d8e63",
                    "options": [
                        {
                            "type": "options.text",
                            "id": "793c3e8c-8599-42d8-b525-458bba23e308",
                            "text": "Examine the Chest",
                            "nodes": [
                                {
                                    "type": "nodes.branch",
                                    "sections": [
                                        {
                                            "type": "nodes.branchSection",
                                            "expression": {
                                                "type": "expressions.inTags",
                                                "scope": "target",
                                                "scopeId": null,
                                                "scopeFilterId": null,
                                                "tags": "examined",
                                                "has": false
                                            },
                                            "nodes": [
                                                {
                                                    "type": "nodes.changeTags",
                                                    "id": "dfcf8eb6-ef8b-4087-ae6a-3483faeea000",
                                                    "scope": "target",
                                                    "scopeId": null,
                                                    "scopeFilterId": null,
                                                    "tagsToAdd": "examined",
                                                    "tagsToRemove": null
                                                },
                                                {
                                                    "type": "nodes.speak",
                                                    "id": "cad893d9-6f79-4699-a167-f7c1e1e92cab",
                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                    "actorId2": null,
                                                    "text": "Hmmm... it's an offering chest someone left here to memorialize the dead.",
                                                    "emotion": "0",
                                                    "emotion2": "0",
                                                    "device": "0",
                                                    "device2": "0"
                                                },
                                                {
                                                    "type": "nodes.speak",
                                                    "id": "af7be25a-ba25-4537-9db7-d945ab41a9da",
                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                    "actorId2": null,
                                                    "text": "Let's take a closer look at it...",
                                                    "emotion": "0",
                                                    "emotion2": "0",
                                                    "device": "0",
                                                    "device2": "0"
                                                },
                                                {
                                                    "type": "nodes.branch",
                                                    "sections": [
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": {
                                                                "type": "expressions.variableComparison",
                                                                "variableScope": "script",
                                                                "variableName": "shawnKneeling",
                                                                "operator": "eq",
                                                                "compareTo": "false",
                                                                "sceneId": "aee3c0c9-4f51-4537-843d-07e84acaff1a",
                                                                "propId": null
                                                            },
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.playAnimation",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "animationName": "KneelDown"
                                                                },
                                                                {
                                                                    "type": "nodes.setVariable",
                                                                    "name": "shawnKneeling",
                                                                    "scope": "script",
                                                                    "sceneId": "a2508b7e-a177-4a96-93bd-4d8ab88dffc4",
                                                                    "source": {
                                                                        "type": "variables.literal",
                                                                        "value": "true",
                                                                        "displayName": "Literal"
                                                                    },
                                                                    "add": false
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "nodes.branch",
                                                    "sections": [
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": {
                                                                "type": "expressions.inTags",
                                                                "scope": "actor",
                                                                "scopeId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                "scopeFilterId": null,
                                                                "tags": "ReadAL",
                                                                "has": true
                                                            },
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "d8566af2-9b91-463b-98a3-c012bc3343c4",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "It looks like a fairly standard Drew class lock... Doesn't even require fancy tools.",
                                                                    "emotion": "0",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": null,
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "7790b530-9f4a-44a2-b467-bf4a149299be",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "It's locked shut.",
                                                                    "emotion": "0",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "nodes.speak",
                                                    "id": "633c8905-6887-424d-b7bb-34354953dcf0",
                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                    "actorId2": null,
                                                    "text": "And I don't see a trap on it. This should be simple to open.",
                                                    "emotion": "0",
                                                    "emotion2": "0",
                                                    "device": "0",
                                                    "device2": "0"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "nodes.branchSection",
                                            "expression": null,
                                            "nodes": [
                                                {
                                                    "type": "nodes.speak",
                                                    "id": "c4da5677-b8c4-479c-b11f-3105ea38ea3b",
                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                    "actorId2": null,
                                                    "text": "I've already checked this chest out thoroughly.",
                                                    "emotion": "0",
                                                    "emotion2": "0",
                                                    "device": "0",
                                                    "device2": "0"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "expression": null,
                            "ignoreChildAvailability": true,
                            "minutes": "5",
                            "ExitMenu": false
                        },
                        {
                            "type": "options.text",
                            "id": "6b5043aa-5a17-4e6b-a1fb-defecbf0f3f3",
                            "text": "Open the Chest",
                            "nodes": [
                                {
                                    "type": "nodes.branch",
                                    "sections": [
                                        {
                                            "type": "nodes.branchSection",
                                            "expression": {
                                                "type": "expressions.inTags",
                                                "scope": "target",
                                                "scopeId": null,
                                                "scopeFilterId": null,
                                                "tags": "locked",
                                                "has": false
                                            },
                                            "nodes": [
                                                {
                                                    "type": "nodes.branch",
                                                    "sections": [
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": {
                                                                "type": "expressions.inTags",
                                                                "scope": "target",
                                                                "scopeId": null,
                                                                "scopeFilterId": null,
                                                                "tags": "looted",
                                                                "has": false
                                                            },
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.changeTags",
                                                                    "id": "a33cd0b2-fbd0-4c32-8592-0d1e3cf62540",
                                                                    "scope": "target",
                                                                    "scopeId": null,
                                                                    "scopeFilterId": null,
                                                                    "tagsToAdd": "looted",
                                                                    "tagsToRemove": null
                                                                },
                                                                {
                                                                    "type": "nodes.branch",
                                                                    "sections": [
                                                                        {
                                                                            "type": "nodes.branchSection",
                                                                            "expression": {
                                                                                "type": "expressions.variableComparison",
                                                                                "variableScope": "script",
                                                                                "variableName": "shawnKneeling",
                                                                                "operator": "eq",
                                                                                "compareTo": "false",
                                                                                "sceneId": "aee3c0c9-4f51-4537-843d-07e84acaff1a",
                                                                                "propId": null
                                                                            },
                                                                            "nodes": [
                                                                                {
                                                                                    "type": "nodes.playAnimation",
                                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                                    "animationName": "KneelDown"
                                                                                },
                                                                                {
                                                                                    "type": "nodes.setVariable",
                                                                                    "name": "shawnKneeling",
                                                                                    "scope": "script",
                                                                                    "sceneId": "a2508b7e-a177-4a96-93bd-4d8ab88dffc4",
                                                                                    "source": {
                                                                                        "type": "variables.literal",
                                                                                        "value": "true",
                                                                                        "displayName": "Literal"
                                                                                    },
                                                                                    "add": false
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "nodes.playSoundEffect",
                                                                    "soundEffectName": "Heavy_Door_Unlock.wav",
                                                                    "wait": false
                                                                },
                                                                {
                                                                    "type": "nodes.wait",
                                                                    "waitForSeconds": "0.2"
                                                                },
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "2151b2b6-756f-4ac4-b953-f1827786132f",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "Let's see... there's some old letters that are falling apart, some moth-eaten cloth... some beads... a good looking throwing knife... and some coins.",
                                                                    "emotion": "0",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                },
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "26696ead-e823-4c39-a473-355bd4a49fc2",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "I'll just take the good stuff. I don't want to be tooo greedy.",
                                                                    "emotion": "1",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                },
                                                                {
                                                                    "type": "nodes.changeInventory",
                                                                    "id": "deb47abd-3848-4dd5-adeb-9ed71193f936",
                                                                    "propId": "cb08f2ac-0112-4d0f-b96f-3f10239d2e51",
                                                                    "sceneId": "a2508b7e-a177-4a96-93bd-4d8ab88dffc4",
                                                                    "change": "1",
                                                                    "count": 1,
                                                                    "notify": true
                                                                },
                                                                {
                                                                    "type": "nodes.changeInventory",
                                                                    "id": "c692e6c8-d541-4456-aa7d-b021c4ebe5a4",
                                                                    "propId": "13351bce-2263-456d-8387-f85cb9af24c4",
                                                                    "sceneId": "a2508b7e-a177-4a96-93bd-4d8ab88dffc4",
                                                                    "change": "1",
                                                                    "count": "2",
                                                                    "notify": true
                                                                },
                                                                {
                                                                    "type": "nodes.changeMoney",
                                                                    "id": "80a9a7a0-1971-4a39-ab32-e77198d328a2",
                                                                    "amount": "20",
                                                                    "change": "1",
                                                                    "currency": "0"
                                                                },
                                                                {
                                                                    "type": "nodes.playAnimation",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "animationName": "KneelUp",
                                                                    "wait": true
                                                                },
                                                                {
                                                                    "type": "nodes.endScript"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": null,
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "8e3d8b7b-9bb8-4a6d-be49-4975af7889fa",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "There's nothing left in here worth taking.",
                                                                    "emotion": "2",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "nodes.branchSection",
                                            "expression": null,
                                            "nodes": [
                                                {
                                                    "type": "nodes.branch",
                                                    "sections": [
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": {
                                                                "type": "expressions.inTags",
                                                                "scope": "target",
                                                                "scopeId": null,
                                                                "scopeFilterId": null,
                                                                "tags": "examined",
                                                                "has": false
                                                            },
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "7eaef9b6-b40c-41b7-a7ba-54ac88c40a1e",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "It's locked, of course. I should have checked it out first.",
                                                                    "emotion": "0",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                },
                                                                {
                                                                    "type": "nodes.changeTags",
                                                                    "id": "12bcd1ba-c247-4d89-9a02-c2c2e3cca824",
                                                                    "scope": "target",
                                                                    "scopeId": null,
                                                                    "scopeFilterId": null,
                                                                    "tagsToAdd": "examined",
                                                                    "tagsToRemove": null
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "nodes.branchSection",
                                                            "expression": null,
                                                            "nodes": [
                                                                {
                                                                    "type": "nodes.speak",
                                                                    "id": "6287d052-a4ca-4e69-bf8e-44d9cd6af466",
                                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                                    "actorId2": null,
                                                                    "text": "I can't open it while it's still locked.",
                                                                    "emotion": "0",
                                                                    "emotion2": "0",
                                                                    "device": "0",
                                                                    "device2": "0"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "expression": null,
                            "ignoreChildAvailability": true,
                            "minutes": "5",
                            "ExitMenu": false
                        },
                        {
                            "type": "options.text",
                            "id": "e3356669-3315-404c-b87d-11aad2461539",
                            "text": "Unlock the Chest",
                            "nodes": [
                                {
                                    "type": "nodes.branch",
                                    "sections": [
                                        {
                                            "type": "nodes.branchSection",
                                            "expression": {
                                                "type": "expressions.variableComparison",
                                                "variableScope": "script",
                                                "variableName": "shawnKneeling",
                                                "operator": "eq",
                                                "compareTo": "false",
                                                "sceneId": "aee3c0c9-4f51-4537-843d-07e84acaff1a",
                                                "propId": null
                                            },
                                            "nodes": [
                                                {
                                                    "type": "nodes.playAnimation",
                                                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                    "animationName": "KneelDown",
                                                    "wait": true
                                                },
                                                {
                                                    "type": "nodes.setVariable",
                                                    "name": "shawnKneeling",
                                                    "scope": "script",
                                                    "sceneId": "a2508b7e-a177-4a96-93bd-4d8ab88dffc4",
                                                    "source": {
                                                        "type": "variables.literal",
                                                        "value": "true",
                                                        "displayName": "Literal"
                                                    },
                                                    "add": false
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "id": "c8e70740-636b-45d6-88c0-d329e6f0fc5f",
                                    "type": "nodes.skillBranch",
                                    "skill": "Tool Use",
                                    "target": "40",
                                    "success": {
                                        "type": "nodes.block",
                                        "nodes": [
                                            {
                                                "type": "nodes.playSoundEffect",
                                                "soundEffectName": "lockpick_success.wav",
                                                "wait": true
                                            },
                                            {
                                                "type": "nodes.speak",
                                                "id": "c114eac6-87fe-40fb-b032-d320f75b7a10",
                                                "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                "actorId2": null,
                                                "text": "That will do it.",
                                                "emotion": "1",
                                                "emotion2": "0",
                                                "device": "0",
                                                "device2": "0"
                                            },
                                            {
                                                "type": "nodes.changeTags",
                                                "id": "c8b8a591-333c-49f0-9626-e8278ce41cd6",
                                                "scope": "target",
                                                "scopeId": null,
                                                "scopeFilterId": null,
                                                "tagsToRemove": "locked"
                                            }
                                        ]
                                    },
                                    "failure": {
                                        "type": "nodes.block",
                                        "nodes": [
                                            {
                                                "type": "nodes.playSoundEffect",
                                                "soundEffectName": "lockpick_failure.wav",
                                                "wait": true
                                            },
                                            {
                                                "type": "nodes.speak",
                                                "id": "adeae4a1-d9d1-4efe-8f11-37384f0b682d",
                                                "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                                "actorId2": null,
                                                "text": "How did I even get into this room with such a lousy lockpick skill? Is this debug mode or something?",
                                                "emotion": "3",
                                                "emotion2": "0",
                                                "device": "0",
                                                "device2": "0"
                                            }
                                        ]
                                    },
                                    "notify": true
                                }
                            ],
                            "expression": {
                                "type": "expressions.and",
                                "left": {
                                    "type": "expressions.inTags",
                                    "scope": "target",
                                    "scopeId": null,
                                    "scopeFilterId": null,
                                    "tags": "examined",
                                    "has": true
                                },
                                "right": {
                                    "type": "expressions.and",
                                    "left": {
                                        "type": "expressions.variableComparison",
                                        "variableScope": "global",
                                        "variableName": "ego.haslockpick",
                                        "operator": "eq",
                                        "compareTo": "true",
                                        "sceneId": "aee3c0c9-4f51-4537-843d-07e84acaff1a",
                                        "propId": null
                                    },
                                    "right": {
                                        "type": "expressions.inTags",
                                        "scope": "target",
                                        "scopeId": null,
                                        "scopeFilterId": null,
                                        "tags": "locked",
                                        "has": true
                                    }
                                }
                            },
                            "ignoreChildAvailability": true,
                            "minutes": "5",
                            "ExitMenu": false
                        },
                        {
                            "type": "options.text",
                            "id": "cbe50aa4-57e6-4135-a294-3c8044244708",
                            "text": "Sense Magic",
                            "nodes": [
                                {
                                    "type": "nodes.invokeScript",
                                    "id": "f04c4a0d-3a95-489b-bd2d-2dc359fa7862",
                                    "scriptId": "533e1ce1-13d3-439f-8544-dbdf808d30c4",
                                    "entryPointId": "bfefdaf4-b4a0-48f6-b64d-cf4a8d13cdf0",
                                    "currentScope": "Scenes",
                                    "currentSceneId": "5f4c53b2-540d-4627-af71-7ede35c6d84b",
                                    "currentActorId": null,
                                    "currentStoryEventId": null,
                                    "currentPropId": null
                                }
                            ],
                            "expression": {
                                "type": "expressions.inTags",
                                "scope": "actor",
                                "scopeId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                                "scopeFilterId": null,
                                "tags": "SenseMagic",
                                "has": true
                            },
                            "ignoreChildAvailability": false,
                            "minutes": "5",
                            "ExitMenu": false
                        }
                    ],
                    "AutoAddDone": true,
                    "Unique": false
                },
                {
                    "type": "nodes.comment",
                    "message": "KneelUp should only do anything if we're already in KneelDown. Putting this here makes sure we never miss restoring our animation state, regardless of whether we knelt down or not.",
                    "commentor": "Charles"
                },
                {
                    "type": "nodes.playAnimation",
                    "actorId": "30ee2636-15e3-452e-a2db-09cbb9012970",
                    "animationName": "KneelUp",
                    "wait": true
                }
            ]
        }
    ]
}